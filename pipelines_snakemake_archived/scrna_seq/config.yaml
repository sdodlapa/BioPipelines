# Single-Cell RNA-seq Analysis Pipeline Configuration
# ===================================================
# For 10x Genomics Chromium data

# Sample information
samples:
  pbmc_1k:
    fastqs: "/scratch/sdodl001/BioPipelines/data/raw/scrna_seq/pbmc_1k_v3_fastqs"
    sample_name: "pbmc_1k_v3"
    description: "1k PBMCs from a Healthy Donor (v3 chemistry)"

# Data directories
data_dir: "/scratch/sdodl001/BioPipelines/data"
raw_dir: "/scratch/sdodl001/BioPipelines/data/raw/scrna_seq"
processed_dir: "/scratch/sdodl001/BioPipelines/data/processed/scrna_seq"
results_dir: "/scratch/sdodl001/BioPipelines/data/results/scrna_seq"

# Reference genome for CellRanger
reference:
  # Download from: https://support.10xgenomics.com/single-cell-gene-expression/software/downloads/latest
  genome: "/scratch/sdodl001/BioPipelines/data/references/refdata-gex-GRCh38-2024-A"
  species: "human"
  
# CellRanger parameters
cellranger:
  chemistry: "auto"  # auto, SC3Pv3, SC3Pv2, SC5P-PE, SC5P-R2
  expect_cells: 1000  # Expected number of cells
  force_cells: null   # Force this many cells, null for auto
  include_introns: false  # Include intronic reads
  
# Seurat analysis parameters
seurat:
  # QC filtering
  qc:
    min_genes: 200      # Min genes per cell
    max_genes: 2500     # Max genes per cell (filter doublets)
    max_mt_percent: 5   # Max mitochondrial content %
  
  # Normalization
  normalization:
    method: "LogNormalize"  # LogNormalize, SCT
    scale_factor: 10000
    
  # Variable features
  variable_features:
    method: "vst"       # vst, mean.var.plot, dispersion
    n_features: 2000
    
  # PCA
  pca:
    n_pcs: 50
    features: null      # null = use variable features
    
  # Clustering
  clustering:
    resolution: 0.5     # 0.4-1.2 for ~1k cells
    algorithm: 1        # 1=Louvain, 2=Louvain+multilevel, 3=SLM, 4=Leiden
    dims: 30           # Number of PCs to use
    
  # UMAP
  umap:
    dims: 30           # Number of PCs to use
    n_neighbors: 30
    min_dist: 0.3
    
  # Differential expression
  de:
    test: "wilcox"     # wilcox, bimod, roc, t, negbinom, poisson, LR, MAST, DESeq2
    logfc_threshold: 0.25
    min_pct: 0.1       # Min fraction of cells expressing
    only_pos: true     # Only positive markers
    
# Cell type annotation
annotation:
  # Marker genes for PBMC cell types
  markers:
    "Naive CD4 T": ["IL7R", "CCR7"]
    "Memory CD4 T": ["IL7R", "S100A4"]
    "CD14 Mono": ["CD14", "LYZ"]
    "B cell": ["MS4A1", "CD79A"]
    "CD8 T": ["CD8A"]
    "FCGR3A Mono": ["FCGR3A", "MS4A7"]
    "NK": ["GNLY", "NKG7"]
    "DC": ["FCER1A", "CST3"]
    "Platelet": ["PPBP"]
    
  # SingleR reference (optional)
  use_singler: false
  singler_ref: "HumanPrimaryCellAtlasData"

# Trajectory analysis (optional)
trajectory:
  enabled: false
  method: "monocle3"  # monocle3, slingshot
  start_cluster: null  # Starting cluster ID
  
# Batch correction (if multiple samples)
integration:
  enabled: false
  method: "harmony"   # harmony, seurat, fastmnn
  
# Visualization
visualization:
  plot_qc: true
  plot_pca: true
  plot_umap: true
  plot_heatmap: true
  plot_violin: true
  plot_dotplot: true
  
# Resources
resources:
  cellranger_mem: "32G"
  cellranger_threads: 8
  seurat_mem: "16G"
  seurat_threads: 4
